<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>주문통합 시스템</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    
    <!-- CSS 파일들 -->
    <link rel="stylesheet" href="styles.css">
    
    <style>
        /* 초기 로딩 화면 */
        .initial-loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 99999;
        }
        
        .initial-loading.hide {
            display: none;
        }
        
        .initial-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2563eb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        .initial-text {
            margin-top: 20px;
            color: #6c757d;
            font-size: 14px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* 초기에 모든 주요 컨테이너 숨김 */
        .login-wrapper,
        .main-system {
            display: none;
        }
    </style>
</head>
<body>
    <!-- (기존 HTML 내용 동일) -->
    
    <!-- JavaScript 파일들 (순서 중요!) -->
    <script src="firebase-config.js"></script>
    <script src="utils.js"></script>
    
    <!-- Config -->
    <script src="js/config/menu-config.js"></script>
    <script src="js/config/stats-config.js"></script>
    
    <!-- Modules -->
    <script src="js/modules/dashboard.js"></script>
    <script src="js/modules/realtime.js"></script>
    <script src="js/modules/search.js"></script>
    <script src="js/modules/excel.js"></script>
    <script src="js/modules/invoice.js"></script>
    <script src="js/modules/analytics.js"></script>
    <script src="js/modules/coupang-sync.js"></script>
    
    <!-- Core -->
    <script src="js/core/tab-manager.js"></script>
    <script src="js/core/auto-refresh.js"></script>
    
    <!-- Main -->
    <script src="auth.js"></script>
    <script src="app.js"></script>
    
    <script>
        // 초기 로딩 처리
        let authInitialized = false;
        
        // Firebase Auth 초기화 확인
        if (typeof auth !== 'undefined') {
            auth.onAuthStateChanged(async (user) => {
                if (!authInitialized) {
                    authInitialized = true;
                    
                    // 초기 로딩 화면 숨기기
                    setTimeout(() => {
                        document.getElementById('initialLoading').classList.add('hide');
                        
                        if (user) {
                            // 로그인 상태 - 메인 화면 표시
                            document.getElementById('loginScreen').style.display = 'none';
                            document.getElementById('mainSystem').style.display = 'block';
                        } else {
                            // 비로그인 상태 - 로그인 화면 표시
                            document.getElementById('loginScreen').style.display = 'flex';
                            document.getElementById('mainSystem').style.display = 'none';
                        }
                    }, 500);
                }
            });
        } else {
            // Firebase 로드 실패 시
            setTimeout(() => {
                document.getElementById('initialLoading').classList.add('hide');
                document.getElementById('loginScreen').style.display = 'flex';
            }, 1000);
        }
    </script>
</body>
</html>